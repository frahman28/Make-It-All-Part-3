<!DOCTYPE html>
<html lang="en">
  <link
    rel=
"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
    type="text/css"
  />
  <script src=
"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script
    src=
"https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"
    type="text/javascript"
  ></script>
  <script src=
"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  
  <script src=
"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.2/Chart.min.js"></script>



<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="formatClean.css">
        <link rel="stylesheet" href="../../public/css/employee_styles.css">

    <script src="../../public/js/all_problems.js" defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>Analysit Home</title>
</head>

<body>
    <div class="text-center image-div">
        <img class="text-center logo" src="../../public/images/logo.png" alt="make-it-all">
    </div>
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#main-links">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="main-links">
                <ul class="navbar-nav">
                    <li class="nav-item px-4"><a href="my_problems.html" class="nav-link">Home</a></li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown  px-4">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Username here
                        </a>
                        <ul class="dropdown-menu bg-dark dropdown-menu-dark" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item" href="settings.html">Settings</a></li>
                            <li><a class="dropdown-item" href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<section>
  <article class = "rightSide">
    <h2>Analysis Specialist</h2>
    <div class="dropdown">
    <button class="dropbtn" style =" border-radius:15px; ">Select Graph </button>
    <div class="dropdown-content">
     
      <a onclick = "displayUP1('individualGraph2')" >Problems Per Specialist</a>
      <a onclick = "displayUP1('individualGraph1')" >Average Time To Fix A Problem</a>
      <!--<a onclick = "displayUP1('individualGraph1')" >Graph 1</a>-->
    </div>
  </div>
    <br>
    <br>
<!-- contains the different graphs shown in the individual side of the page-->
    <div style= "display:block; background-color: white; width: 100%; border-radius:15px; height: 100%; box-shadow: 5px 10px 10px #979696;" id = "individualGraph2">
        <canvas id="bar-chart-problemPerSpecilist"></canvas>
    </div>
    <div style= "display:none; background-color: white; width: 100%; border-radius:15px; height: 100%;box-shadow: 5px 10px 10px #979696;" id = "individualGraph1">
         <canvas id="bar-chart-time-fix"></canvas>       
    </div>
    
  
<!-- The selection of graphs using the dropdown button-->
    <script>
    function displayUP1(option) {
      var a1 = document.getElementById("individualGraph1");
      var b1 = document.getElementById("individualGraph2");
      var c1 = document.getElementById("individualGraph3");

      if (option == 'individualGraph1'){
        a1.style.display = "block";
        b1.style.display = "none";
        c1.style.display = "none";
      }

      if (option == 'individualGraph2'){
        a1.style.display = "none";
        b1.style.display = "block";
        c1.style.display = "none";
      }

      if (option == 'individualGraph3'){
        a1.style.display = "none";
        b1.style.display = "none";
        c1.style.display = "block";
      }
    }
  </script>
  <br>
  <br>
<!-- Filter Table for employees so analyst cant find more information about employee-->
 <div class="container">
        <form action="">
            <div class="row">
                <div class="col-6">
                    <input type="text" id="search-area" name="search-area" class="form-control" placeholder="Search..">
                </div>
                <div class="col-4">
                    <select id="search-by" name="search-by" class="form-select">
                        <option selected>Search By</option>
                        <option value="first">Employee ID</option>
                        <option value="second">Employee Name</option>
                        <option value="td:third">Job Title</option>
                        <option value="td:fourth">Jobs currently</option>
                    </select>
                </div>
                
        </form>
    </div>
    <br>
    <div class="container">
        <table class="all-problem-table table table-bordered accordion">
            <thead>
                <tr class="table-secondary">
                    <th value = "0">Serial Number</th>
                    <th value = "1" >Equpiment Make</th>
                    <th value = "2" >Equpiment Type</th>
                    <th value = "3" >Software Running</th>
                </tr>
            </thead>
            <tbody id="view-equpiment-table">
                <!-- Dummy data, remove when taking data from database -->
                <tr class="visible-row accordion" data-bs-toggle="collapse">
                    <td>#1</td>
                    <td>15/03/2022</td>
                    <td>Dropped laptop in water.</td>
                    <td>Windows </td>
                </tr>
                <tr class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                    <td class="hidden-data" colspan="4">
                        <div class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                            <br>
                            <table class="hidden-table table table-striped table-bordered">
                                <tr>
                                    <td>Problem ID:</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>Problem Type:</td>
                                    <td>Hardware</td>
                                </tr>
                                <tr>
                                    <td>Problem Description:</td>
                                    <td>Dropped laptop in water.</td>
                                </tr>
                                <tr>
                                    <td>Solution:</td>
                                    <td>Submerge in bag of rice for 24 hours.</td>
                                </tr>
                                <tr>
                                    <td>Employee Name:</td>
                                    <td>Lisa Poole</td>
                                </tr>
                                <tr>
                                    <td>Specialist Name:</td>
                                    <td>Bert Thompson</td>
                                </tr>
                                <tr>
                                    <td>Opened on:</td>
                                    <td>07/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Closed on:</td>
                                    <td>15/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Operating System:</td>
                                    <td>Windows 10</td>
                                </tr>
                                <tr>
                                    <td>Software Name:</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>Software Type:</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>Device Name:</td>
                                    <td>Asus Chromebook</td>
                                </tr>
                                <tr>
                                    <td>Equipment type:</td>
                                    <td>Laptop</td>
                                </tr>
                                <tr>
                                    <td>Serial Number:</td>
                                    <td>299388</td>
                                </tr>
                            </table>
                            <br>
                        </div>
                    </td>
                </tr>
                <tr class="visible-row accordion" data-bs-toggle="collapse">
                    <td>#2</td>
                    <td>09/03/2022</td>
                    <td>Chrome keeps freezing.</td>
                    <td>MacOS</td>
                </tr>
                <tr class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                    <td class="hidden-data" colspan="4">
                        <div class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                            <br>
                            <table class="hidden-table table table-striped table-bordered">
                                <tr>
                                    <td>Problem ID:</td>
                                    <td>2</td>
                                </tr>
                                <tr>
                                    <td>Problem Type:</td>
                                    <td>Software</td>
                                </tr>
                                <tr>
                                    <td>Problem Description:</td>
                                    <td>Chrome keeps freezing.</td>
                                </tr>
                                <tr>
                                    <td>Solution:</td>
                                    <td>Clear cache.</td>
                                </tr>
                                <tr>
                                    <td>Employee Name:</td>
                                    <td>Johnny Ipkiss</td>
                                </tr>
                                <tr>
                                    <td>Specialist Name:</td>
                                    <td>Clara Hart</td>
                                </tr>
                                <tr>
                                    <td>Opened on:</td>
                                    <td>03/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Closed on:</td>
                                    <td>09/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Operating System:</td>
                                    <td>Windows 8</td>
                                </tr>
                                <tr>
                                    <td>Software Name:</td>
                                    <td>Google Chrome</td>
                                </tr>
                                <tr>
                                    <td>Software Type:</td>
                                    <td>Application</td>
                                </tr>
                                <tr>
                                    <td>Device Name:</td>
                                    <td>Dell Inspiron</td>
                                </tr>
                                <tr>
                                    <td>Equipment type:</td>
                                    <td>PC</td>
                                </tr>
                                <tr>
                                    <td>Serial Number:</td>
                                    <td>726188</td>
                                </tr>
                            </table>
                            <br>
                        </div>
                    </td>
                </tr>
                <tr class="visible-row accordion" data-bs-toggle="collapse">
                    <td>#3</td>
                    <td>24/02/2022</td>
                    <td>iPad touch screen stopped working.</td>
                    <td>Linux</td>
                </tr>
                <tr class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                    <td class="hidden-data" colspan="4">
                        <div class="accordion-collapse collapse" data-bs-parent=".all-problem-table">
                            <br>
                            <table class="hidden-table table table-striped table-bordered">
                                <tr>
                                    <td>Problem ID:</td>
                                    <td>6</td>
                                </tr>
                                <tr>
                                    <td>Problem Type:</td>
                                    <td>Hardware</td>
                                </tr>
                                <tr>
                                    <td>Problem Description:</td>
                                    <td>iPad touch screen stopped working.</td>
                                </tr>
                                <tr>
                                    <td>Solution:</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>Employee Name:</td>
                                    <td>Johnny Ipkiss</td>
                                </tr>
                                <tr>
                                    <td>Specialist Name:</td>
                                    <td>Bert Thompson</td>
                                </tr>
                                <tr>
                                    <td>Opened on:</td>
                                    <td>10/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Closed on:</td>
                                    <td>17/03/2022</td>
                                </tr>
                                <tr>
                                    <td>Operating System:</td>
                                    <td>iOS 15</td>
                                </tr>
                                <tr>
                                    <td>Software Name:</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>Software Type:</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>Device Name:</td>
                                    <td>iPad Air</td>
                                </tr>
                                <tr>
                                    <td>Equipment type:</td>
                                    <td>iPad</td>
                                </tr>
                                <tr>
                                    <td>Serial Number:</td>
                                    <td>898181</td>
                                </tr>
                            </table>
                            <br>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

        <script>
            $(document).ready(function(){
              $("#search-area").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $("#view-equpiment-table tr").filter(function() {
                    $(this).toggle($(this).find(("#search-by").value).text().toLowerCase().indexOf(value) > -1)                });
              });
            });


            
        </script>

<!-- putting graphs in respective divs-->
  </article>
  <article class = "leftSide" >
    <h2>Analysis Problems</h2>
    <div class="dropdown">
    <button class="dropbtn" style =" border-radius:15px; ">Select Graph</button>
    <div class="dropdown-content">
      <a onclick = "displayUP('companyGraph1')" >Number of SoftWare And Hardware Issues</a>
      <a onclick = "displayUP('companyGraph2')" >Most Faulty Equipment</a>
      <a onclick = "displayUP('companyGraph3')" >Number of each Problem Type</a>
    </div>
  </div>
    <br>
    <br>

    <div style= "display:block; background-color: white; width: 100%; border-radius:15px; height: 100%; box-shadow: 5px 10px 10px #979696;" id = "companyGraph1">
       <canvas id="softwareAndHardware"></canvas>
    </div>
    <div style= "display:none; background-color: white; width: 100%; border-radius:15px; height: 100%; box-shadow: 5px 10px 10px #979696;" id = "companyGraph2">
      <canvas id="bar-chart-faultyEquipment"></canvas>
    </div>
    <div style= "display:none; background-color: white; width: 100%; border-radius:15px; height: 100%; box-shadow: 5px 10px 10px #979696;" id = "companyGraph3">    
    <canvas id="pie-chart-problemType"></canvas>
    </div>
     
     
<!--Function for the graph selection button-->
    <script>
    function displayUP(option) {
      var a = document.getElementById("companyGraph1");
      var b = document.getElementById("companyGraph2");
      var c = document.getElementById("companyGraph3");

      if (option == 'companyGraph1'){
        a.style.display = "block";
        b.style.display = "none";
        c.style.display = "none";
      }

      if (option == 'companyGraph2'){
        a.style.display = "none";
        b.style.display = "block";
        c.style.display = "none";
      }

      if (option == 'companyGraph3'){
        a.style.display = "none";
        b.style.display = "none";
        c.style.display = "block";
      }
    }
  </script>

  <br>
  <br>
<!--Extra stats aboiut the company -->
  <label style="background-color : white;border:solid; width: 100%; padding: 12px;border-style: outset;border-radius: 15px;" for="companyStat">Most Common Problem Type: <?php echo $popularProblem?>  </label> 
  <br>
  <br>
  <label style="background-color :white;border-color: lilac;border-style: outset;border-radius: 15px; width: 100%; padding: 12px;" for="companyStat">Average Days to Solve Problem: <?php echo json_decode($avgTime) ?> </label>
  <br>
  <br>
  <label style="background-color : white;border:  solid; width: 100%; padding: 12px;border-style: outset;border-radius: 15px;" for="companyStat">Total Problem Count : <?php echo json_decode($allProblems) ?> </label>
  <br>
  <br>
  <br>
  <br>


  </article>
</section>


<!--------Creation of Graphs with dummy data-------->
<script>

    var ctxL = document.getElementById("softwareAndHardware").getContext('2d');
        var myLineChart = new Chart(ctxL, {
          type: 'line',
          data: {
            labels: ["January", "February", "March", "April", "May", "June", "July"],
            datasets: [{
              label: "Software And Hardware Issues",
              data: [65, 59, 80, 81, 56, 55, 40],
              backgroundColor: [
                'rgba(105, 0, 132, .2)',
              ],
              borderColor: [
                'rgba(200, 99, 132, .7)',
              ],
              borderWidth: 2
            },
            {
              label: "Hardware Issues",
              data: [28, 48, 40, 19, 86, 27, 90],
              backgroundColor: [
                'rgba(0, 137, 132, .2)',
              ],
              borderColor: [
                'rgba(0, 10, 130, .7)',
              ],
              borderWidth: 2
            }
            ]
          },
          options: {
            responsive: true
          }
        });




    new Chart(document.getElementById("pie-chart-problemType"), {
        type: 'pie',
        data: {
          labels: ["Africa", "Asia", "Europe", "Latin America", "North America"],
          datasets: [{
            label: "Problem Type",
            backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
            data: [2478,5267,734,784,433]
          }]
        },
        options: {
          title: {
            display: true,
            text: 'Predicted world population (millions) in 2050'
          }
        }
    });


    </script>
    <script type="text/javascript">



    var ctx = document.getElementById("bar-chart-time-fix").getContext('2d');
      var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
          datasets: [{
            label: 'Average time to fix',
            data: [12, 19, 3, 5, 2, 3],
            backgroundColor: [
              'rgba(255, 99, 132, 0.2)',
              'rgba(54, 162, 235, 0.2)',
              'rgba(255, 206, 86, 0.2)',
              'rgba(75, 192, 192, 0.2)',
              'rgba(153, 102, 255, 0.2)',
              'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
              'rgba(255,99,132,1)',
              'rgba(54, 162, 235, 1)',
              'rgba(255, 206, 86, 1)',
              'rgba(75, 192, 192, 1)',
              'rgba(153, 102, 255, 1)',
              'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true
              }
            }]
          }
        }
      });






  


    var ctx = document.getElementById("bar-chart-faultyEquipment").getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
      datasets: [{
        label: 'Faulty Equipment',
        data: [12, 19, 3, 5, 2, 3],
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          'rgba(255, 159, 64, 0.2)'
        ],
        borderColor: [
          'rgba(255,99,132,1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: true
          }
        }]
      }
    }
  });




     var ctx = document.getElementById("bar-chart-problemPerSpecilist").getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
      datasets: [{
        label: 'Problem Per Specilist',
        data: [12, 19, 3, 5, 2, 3],
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          'rgba(255, 159, 64, 0.2)'
        ],
        borderColor: [
          'rgba(255,99,132,1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: true
          }
        }]
      }
    }
  });

    </script>

<footer>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>


<!--------Code Needed to automate Graphs------->
<script type = "text/javascript">

        function showData(header,yValues,labels) {
        var data = {
          labels: labels,
          datasets: [{
            label: header,
            backgroundColor:  [
                        'rgba(204, 204, 255, 0.4)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(64, 128, 191, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 204, 102,0.5)',
                        'rgba(204, 255, 255,0.8)',
                        'rgba(255, 255, 102, 0.3)',
                        'rgba(255, 159, 64, 0.2)'
              
                    ],
         
            data: yValues,
          }]
        };
        return data;
    }

        function config(yValues,barType,title) {
            var config = {
            type: barType,
            data: yValues,
            options: { title: {
      display: true,
      text: title} }};
         return config;
        }
  <!--Specific configuration funstion for bar charts -->
    function configBar(yValues,barType,title) {
      var configBar = {
            type: barType,
            data: yValues,
            options: { title: {
      display: true,
      text: title},
      scales:{
        yAxes: [{ticks: {min: 0, max: 16}}],
    },
           }}; 
      return configBar;
    }
    
    
<!--Implememtation of data into graphs using JSON, also setting the graph labels and other components-->
    var dataP = JSON.parse('<?php echo json_encode($problems) ?>');
    var dataLabels = JSON.parse('<?php echo json_encode($month) ?>');
    var barChart = new Chart(
        document.getElementById('barCoProblems'),
        configBar(showData("Problems", dataP, dataLabels),'bar',"Number of Problems Per Month")
    );
      
    var calls = JSON.parse('<?php echo json_encode($noCall) ?>');
    var callLabels = JSON.parse('<?php echo json_encode($months2) ?>');
    var barChart = new Chart(
        document.getElementById('barIndProblems'),
        configBar(showData('Calls',calls,callLabels),'bar',"Number of Calls Per Month")
    );

   
    var unsolved = JSON.parse('<?php echo json_encode($unsolved) ?>');
    var solved = JSON.parse('<?php echo json_encode($solved) ?>');
    var pieChart = new Chart(
        document.getElementById('pieCoSolved'),
        config(showData('Solved and unsolved',[(unsolved-solved),solved],["Unsolved","Solved"]),'doughnut', "Current Number of Problems")
    );

    var noProblems = JSON.parse('<?php echo json_encode($noTypes) ?>');
    var problemType = JSON.parse('<?php echo json_encode($problemType) ?>');
    var pieChart = new Chart(
        document.getElementById('pieCoTypes'),
        config(showData('Number of each Problem Type',noProblems,problemType),'doughnut', "Current Amount of Each Problem Type")
    );
    
    var noCalls = JSON.parse('<?php echo json_encode($noCalls) ?>');
    var names = JSON.parse('<?php echo json_encode($name) ?>');
    var barChart = new Chart(
        document.getElementById('barIndnoProblems'),
        configBar(showData('Calls',noCalls,names),'line',"Number of Calls ")
    );
      
      
   var nameSpecialist = JSON.parse('<?php echo json_encode($nameSpecialist) ?>');
   var current = JSON.parse('<?php echo json_encode($current) ?>');
   var barChart = new Chart(
        document.getElementById('barIndSpecial'),
        configBar(showData('Problems',current,nameSpecialist),'bar',"Number of Problems ")
    );
  </script>

</body>
</html>